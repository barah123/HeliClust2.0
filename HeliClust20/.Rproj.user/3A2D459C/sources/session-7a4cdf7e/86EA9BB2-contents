
library(HeliClust20)

# 1. Read your metabolite data
lcs_1 <- read.csv("lcs_v1.csv", row.names = 1)



# 2. Run clustering for metabolites
hc_met <- heliclust_metabolites(lcs_1,
                                dist_method   = "euclidean",
                                hclust_method = "ward.D2",
                                scale_data    = TRUE)
# 3. Plot dendrogram
plot(hc_met)

#Run distance matrix for heatmaps
dist_mat <- heliclust_dist(lcs_1,
                           dist_method = "euclidean",
                           scale_data  = TRUE)

heatmap(dist_mat)   # works: numeric matrix





# 4. If you want the distance matrix and to save it:
dist_mat <- heliclust_dist(lcs_1,
                           dist_method = "euclidean",
                           scale_data  = TRUE)

write.table(dist_mat, "lcs_1_dist.txt",
            sep = "\t", eol = "\n",
            na = "", col.names = NA,
            quote = FALSE, row.names = TRUE)


#Hierarchical clustering for sequence / OTU data
# 1. Read your OTU data
skin_microbes <- read.csv("ASV.csv", row.names = 1, check.names = FALSE)
skin_microbes <- t(skin_microbes)

# 2. Run clustering for for OTU
hc_seq <- heliclust_sequences(
  skin_microbes,
  dist_method = "bray",
  hclust_method = "average",
  scale_data = FALSE
)

plot(hc_seq)

#Run distance matrix for heatmaps
seq_dist_mat <- heliclust_dist( skin_microbes,
                                dist_method = "bray",
                                scale_data  = FALSE)
heatmap(seq_dist_mat)
